package telegram

import (
	tgbotapi "github.com/go-telegram-bot-api/telegram-bot-api"
	"math/rand"
	"tcs/machanics/miner"
	"tcs/models"
	"time"
)

var canteenIdleMessages = []string{
	//"- –°–ª—ã—à–∞–ª, –õ—å–≤–∞ –ê–±–∞–ª–∫–∏–Ω–∞ —É–±–∏–ª–∏.\n- –ê –∫—Ç–æ —ç—Ç–æ?\n- –ù—É —Ç—ã —á–µ? –≠—Ç–æ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –≥–æ–ª–æ–≤–∞–Ω–∞–º!\n- –î–∞ —Ç–æ—á–Ω–æ, –≤—Å–ø–æ–º–Ω–∏–ª!!",
	"- –ü–æ–≥–æ–¥–∞ –æ—Ç–ª–∏—á–Ω–∞—è –Ω–∞ –ø–ª–∞–Ω–µ—Ç–µ! –•–æ—Ç—å –Ω–∞ –º–æ—Ä–µ –µ–¥—å...",
	"- –¢–∞—Ö–æ—Ä–≥–∏ - —ç—Ç–æ –∑–¥–æ—Ä–æ–≤–µ–Ω–Ω—ã–µ —á—É–¥–æ–≤–∏—â–∞ —Å –ø–∞–Ω–¥–æ—Ä—ã! –ì–æ–≤–æ—Ä—è—Ç –µ–≥–æ –≤–∏–¥–µ–ª–∏ –Ω–∞ —ç—Ç–æ–π –ø–ª–∞–Ω–µ—Ç–µ...\n- –û–Ω —Å—é–¥–∞ —Å–∞–º –ø–µ—à–∫–æ–º –ø—Ä–∏—à–µ–ª?",
	"- –Ø –ª–∏—á–Ω–æ –Ω–µ –≤–∏–¥–µ–ª, –Ω–æ –∑–Ω–∞—é –ø–∞—Ä–Ω—è, –∫–æ—Ç–æ—Ä—ã–π —Ç–æ—á–Ω–æ –≤–∏–¥–µ–ª –∫–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –∏–∑ –≤–æ–¥—ã –≤—ã–¥–µ–ª—è–µ—Ç –∫–∏—Å–ª–æ—Ä–æ–¥ –∏ –Ω–∞ —Ö–æ–¥—É –º–æ–∂–Ω–æ –±–∞–ª–ª–æ–Ω—ã –ø–æ–ø–æ–ª–Ω–∏—Ç—å!\n- –ê –æ–Ω —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–ª –∫–∞–∫ —ç—Ç–æ—Ç –∫–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä –≤—ã–≥–ª—è–¥–∏—Ç?",
	"- –¢–∞–≥–æ—Ä—è–Ω–µ –æ—Ç–æ–∑–≤–∞–ª–∏ –¥–∏–ø–º–∏—Å—Å–∏—é —Å –ó–µ–º–ª–∏ 9 –ª–µ—Ç –Ω–∞–∑–∞–¥!\n- –ë—ã—Å—Ç—Ä–æ –≤—Ä–µ–º—è –ª–µ—Ç–∏—Ç, –∫–∞–∫ –≤—á–µ—Ä–∞ –±—ã–ª–æ...",
	"- –ù–æ—á—å—é –ª—É—á—à–µ –Ω–µ —Ö–æ–¥–∏ –≤ –ø—É—Å—Ç—ã–Ω—é, —Ç–∞–º –∂–∏–≤–Ω–æ—Å—Ç—å –æ—á–µ–Ω—å –∑–ª–∞—è!\n- –Ø —É–∂–µ —Ö–æ–¥–∏–ª! –í—Å—Ç—Ä–µ—Ç–∏–ª –∞–Ω–æ–º–∞–ª–∏—é, –æ–∫–∞–∑–∞–ª–∞—Å—å —Å–∏–ª—å–Ω–µ–µ —á–µ–º –¥–Ω–µ–º, –Ω–æ –¥–æ–±—ã—á–∞ –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—Ç...",
	"- –°—Ç–æ—è–ª–∏ –∑–≤–µ—Ä–∏ –æ–∫–æ–ª–æ –¥–≤–µ—Ä–∏, –≤ –Ω–∏—Ö —Å—Ç—Ä–µ–ª—è–ª–∏, –æ–Ω–∏ —É–º–∏—Ä–∞–ª–∏...",
	"- –í —Å—Ç–æ–ª–æ–≤–æ–π —Ö–æ—Ä–æ—à–æ! –ü–æ–µ–ª - ‚ù§Ô∏è –•–ü –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–ª!",
	//"- –ù–∞ –°–∞—Ä–∞–∫—à–µ —Å–µ–π—á–∞—Å !",
}

func canteen(avatar *models.Avatar) {
	avatar.Player.HP = 10
	avatar.Player.UpdateHP()
	text := avatar.HealthMessage()
	text += "\nüçú –°—Ç–æ–ª–æ–≤–∞—è\n–í–æ –≤—Ä–µ–º—è –æ–±–µ–¥–∞ —Ç—ã –ø–æ–¥—Å–ª—É—à–∞–ª —Ä–∞–∑–≥–æ–≤–æ—Ä –∑–∞ —Å–æ—Å–µ–¥–Ω–∏–º —Å—Ç–æ–ª–æ–º:\n"
	if time.Now().Sub(avatar.CanteenMessage) < time.Minute {
		text += canteenIdleMessages[rand.Intn(len(canteenIdleMessages))]
	} else {
		text += miner.GetAllSpots(avatar.Player.Location)
		avatar.CanteenMessage = time.Now()
	}
	msg := tgbotapi.NewMessage(avatar.ChatID(), text)
	//msg.ReplyMarkup = menu.CanteenMenu
	//avatar.MenuHistory.Push(&menu.BaseMenu)
	Send(avatar.ChatID(), msg)
}
